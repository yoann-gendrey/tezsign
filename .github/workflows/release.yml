name: "Build Armbian (Radxa Zero 3)"

on:
  push:
  pull_request:

jobs:
  build-armbian:
    runs-on: ubuntu-24.04-arm
    steps:
      - name: Checkout
        uses: actions/checkout@v5

      - name: Build Armbian Image
        uses: ./.github/template/build-armbian
        with:
          artifact_id: "radxa_zero3"
          armbian_token: ${{ secrets.GITHUB_TOKEN }}
          armbian_board: "radxa-zero3"
          armbian_release: "trixie"
          armbian_boot_scenario: "binman-atf-mainline"
          tezsign_flavour: "prod"

      - name: Upload Armbian Image Artifact
        uses: actions/upload-artifact@v5
        with:
          name: radxa_zero3
          path: ./build/output/*.img      # Adjust path if your build-armbian outputs elsewhere
          retention-days: 7
